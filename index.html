<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Êñá‰ª∂Á¥¢Âºï | GitHub È£éÊ†º</title>
    <style>
        :root {
            --github-black: #24292e;
            --github-blue: #0366d6;
            --github-gray: #f6f8fa;
            --github-border: #e1e4e8;
            --github-text: #24292e;
            --github-text-secondary: #586069;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif;
            line-height: 1.5;
            color: var(--github-text);
            background-color: white;
            margin: 0;
            padding: 0;
        }
        
        .container {
            max-width: 1012px;
            margin: 0 auto;
            padding: 16px;
        }
        
        header {
            padding: 16px 0;
            border-bottom: 1px solid var(--github-border);
            margin-bottom: 16px;
        }
        
        h1 {
            font-size: 24px;
            font-weight: 600;
            margin: 0;
            color: var(--github-black);
        }
        
        .path {
            font-size: 14px;
            color: var(--github-text-secondary);
            margin-top: 8px;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 14px;
            border: 1px solid var(--github-border);
            border-radius: 6px;
            overflow: hidden;
        }
        
        th {
            background-color: var(--github-gray);
            color: var(--github-text-secondary);
            padding: 10px 16px;
            text-align: left;
            font-weight: 600;
            border-bottom: 1px solid var(--github-border);
        }
        
        td {
            padding: 10px 16px;
            border-bottom: 1px solid var(--github-border);
        }
        
        tr:last-child td {
            border-bottom: none;
        }
        
        tr:hover {
            background-color: var(--github-gray);
        }
        
        a {
            color: var(--github-blue);
            text-decoration: none;
            cursor: pointer;
        }
        
        a:hover {
            text-decoration: underline;
        }
        
        .icon {
            margin-right: 8px;
            color: var(--github-text-secondary);
            width: 16px;
            text-align: center;
            display: inline-block;
        }
        
        .loading, .error {
            padding: 40px;
            text-align: center;
            color: var(--github-text-secondary);
        }
        
        .error {
            color: #cb2431;
        }
        
        .footer {
            margin-top: 40px;
            padding-top: 16px;
            border-top: 1px solid var(--github-border);
            color: var(--github-text-secondary);
            font-size: 12px;
            text-align: center;
        }
        
        .sortable {
            cursor: pointer;
            position: relative;
        }
        
        .sortable:hover {
            text-decoration: underline;
        }
        
        .sorted-asc::after {
            content: " ‚Üë";
            color: var(--github-blue);
        }
        
        .sorted-desc::after {
            content: " ‚Üì";
            color: var(--github-blue);
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Êñá‰ª∂Á¥¢Âºï</h1>
            <div class="path">ÂΩìÂâçË∑ØÂæÑ: /</div>
        </header>

        <div id="content">
            <div class="loading">Âä†ËΩΩÊñá‰ª∂ÂàóË°®‰∏≠...</div>
        </div>

        <div class="footer">
            <p>¬© <span id="year"></span> GitHub È£éÊ†ºÊñá‰ª∂Á¥¢Âºï</p>
        </div>
    </div>

    <script>
        // ÈÖçÁΩÆ‰ø°ÊÅØ
        const config = {
            owner: 'YOUR_USERNAME',
            repo: 'YOUR_REPO',
            path: ''  // ÂèØ‰ª•ËÆæÁΩÆ‰∏∫Â≠êÁõÆÂΩïÂ¶Ç 'download'
        };

        // ÂÖ®Â±ÄÊï∞ÊçÆ
        let allFiles = [];
        let currentSort = { field: 'name', direction: 'asc' };

        // ‰∏ªÂáΩÊï∞
        async function init() {
            document.getElementById('year').textContent = new Date().getFullYear();
            
            try {
                // Â∞ùËØï‰ªéGitHub APIËé∑ÂèñÊï∞ÊçÆ
                const apiUrl = `https://api.github.com/repos/${config.owner}/${config.repo}/contents/${config.path}`;
                const response = await fetch(apiUrl);
                
                if (!response.ok) {
                    throw new Error(`HTTPÈîôËØØ! Áä∂ÊÄÅÁ†Å: ${response.status}`);
                }
                
                const files = await response.json();
                
                if (!Array.isArray(files)) {
                    throw new Error('Êó†ÊïàÁöÑÂìçÂ∫îÊ†ºÂºè');
                }
                
                // Â§ÑÁêÜÊñá‰ª∂Êï∞ÊçÆ
                allFiles = files.map(file => ({
                    ...file,
                    sizeNum: file.size || 0,
                    dateNum: file.last_modified ? new Date(file.last_modified).getTime() : 0,
                    isDir: file.type === 'dir',
                    downloadUrl: file.download_url || file.html_url
                }));
                
                renderFileTable();
            } catch (error) {
                showError(error);
            }
        }

        // Ê∏≤ÊüìË°®Ê†º
        function renderFileTable() {
            const content = document.getElementById('content');
            
            if (allFiles.length === 0) {
                content.innerHTML = '<div class="error">ÁõÆÂΩï‰∏∫Á©∫</div>';
                return;
            }
            
            content.innerHTML = `
                <table>
                    <thead>
                        <tr>
                            <th class="sortable ${getSortClass('name')}" onclick="sortFiles('name')">ÂêçÁß∞</th>
                            <th class="sortable ${getSortClass('size')}" onclick="sortFiles('size')">Â§ßÂ∞è</th>
                            <th class="sortable ${getSortClass('date')}" onclick="sortFiles('date')">‰øÆÊîπÊó•Êúü</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${allFiles.map(file => `
                            <tr>
                                <td>
                                    <span class="icon">${file.isDir ? 'üìÅ' : 'üìÑ'}</span>
                                    ${file.isDir ? 
                                        `<span>${file.name}</span>` : 
                                        `<a href="${file.downloadUrl}" download="${file.name}">${file.name}</a>`
                                    }
                                </td>
                                <td>${!file.isDir && file.sizeNum ? formatSize(file.sizeNum) : '-'}</td>
                                <td>${file.dateNum ? new Date(file.dateNum).toLocaleString() : '-'}</td>
                            </tr>
                        `).join('')}
                    </tbody>
                </table>
            `;
        }

        // ÊéíÂ∫èÂáΩÊï∞
        function sortFiles(field) {
            const direction = currentSort.field === field && currentSort.direction === 'asc' ? 'desc' : 'asc';
            currentSort = { field, direction };
            
            allFiles.sort((a, b) => {
                const valA = getSortValue(a, field);
                const valB = getSortValue(b, field);
                return (valA < valB ? -1 : 1) * (direction === 'asc' ? 1 : -1);
            });
            
            renderFileTable();
        }

        // ËæÖÂä©ÂáΩÊï∞
        function getSortValue(file, field) {
            if (field === 'size') return file.sizeNum;
            if (field === 'date') return file.dateNum;
            return file.name.toLowerCase();
        }

        function getSortClass(field) {
            return currentSort.field === field ? `sorted-${currentSort.direction}` : '';
        }

        function formatSize(bytes) {
            if (bytes < 1024) return bytes + ' B';
            const units = ['KB', 'MB', 'GB'];
            let size = bytes;
            let unitIndex = -1;
            while (size >= 1024 && unitIndex < units.length - 1) {
                size /= 1024;
                unitIndex++;
            }
            return size.toFixed(2) + ' ' + units[unitIndex];
        }

        function showError(error) {
            document.getElementById('content').innerHTML = `
                <div class="error">
                    <p>Âä†ËΩΩÊñá‰ª∂ÂàóË°®Â§±Ë¥•</p>
                    <p><strong>ÂéüÂõ†:</strong> ${error.message}</p>
                    <p>ËØ∑Ê£ÄÊü•:</p>
                    <ul>
                        <li>‰ªìÂ∫ìÊòØÂê¶‰∏∫ÂÖ¨ÂºÄ</li>
                        <li>‰ªìÂ∫ìÂêçÁß∞ÊòØÂê¶Ê≠£Á°Æ</li>
                        <li>GitHub Pages ÊòØÂê¶Â∑≤ÂêØÁî®</li>
                    </ul>
                </div>
            `;
        }

        // ÂÖ®Â±ÄÂáΩÊï∞
        window.sortFiles = sortFiles;
        
        // ÂàùÂßãÂåñ
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
